in forum_show.cgi 

if ($pmCell || $favCell || $onlineCell) { 
.................. 
} 

µÄºóÃæ: 


  ###add by scud  my $everyline=10;  my $div_td=int(100/$everyline);  # Get online users  my $includeMyself;  my $showHidden;    if ($user->{'defaultUser'}) {      $includeMyself = "";  }  else {      $includeMyself = $cfg{'inclMyself'} ?  ""  : "AND userId <> $user->{'id'}";  }    if ($cfg{'showHidden'} eq "admin") {       $showHidden = ($user->{'admin'} or $user->{'superMod'}) ?  "" : "AND hidden = 0";  }  elsif ($cfg{'showHidden'} eq "moderator") {       $showHidden = ($user->{'admin'} or $user->{'moderator'} or $user->{'superMod'}) ?  "" : "AND hidden = 0";  }  else {      $showHidden = "AND hidden = 0";  }    my $activeTime = time() - $cfg{'inactiveTime'} * 60;    my $query = "      SELECT *         FROM ut_online     WHERE lastOnTime > $activeTime        $showHidden       $includeMyself     ORDER BY lastOnTime DESC";  my $sth = query($query);  my $onlineUsers = $sth->fetchall_arrayref({});  $sth->finish;    my $rowColor = $cfg{'lightCellColor2'};  # Print user list header  print     tableStart($user),    "<TR bgcolor=$cfg{'darkCellColor'}>\n",    "<TD><font color=$cfg{'darkCellTColor'}><B>Online Users</B></font></TD>\n",    "</TR>\n\n";    my $regUsers = 0;  my $guests = 0;    print     "<TR><TD BGCOLOR=$rowColor align=center>";    print     tableStart($user,'','','','center');      # Print online user list  for my $onlineUser (@$onlineUsers) {    my $userId = $onlineUser->{'userId'};      my $lastOnTime = formatTime($onlineUser->{'lastOnTime'});              if ($userId > 0) {          if($regUsers%$everyline==0)        {          print "<tr>";                    }      print      "<TD BGCOLOR=$rowColor width=$div_td","\%>",      "<A HREF='user_info.cgi?id=$userId'>$onlineUser->{'userName'}</A>",      "</td>";              if($regUsers%$everyline==($everyline-1))        {          print  "</tr>";         }                $regUsers++;        if ($rowColor eq $cfg{'lightCellColor2'}) {             $rowColor = $cfg{'lightCellColor'};        }        else {            $rowColor = $cfg{'lightCellColor2'};        }    }    else {      $guests++;    }      }    print    tableEnd($user);        print           "</td></tr>\n";    print    tableEnd($user),      "<table border=0 cellspacing=0 cellpadding=2 width=95%>\n",    "<tr><td>\n",    "<b>$regUsers</b> $lng{'onlineRegUsers'}, <b>$guests</b> $lng{'onlineGuests'}",    "</td></tr>\n",    "</table>\n";    ###add end  
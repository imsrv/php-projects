#!/usr/local/bin/perl
#
# -- Please Check the above line. This must show to the Path-to-Perl on your server -- ##
#_____________________________________________________________________________________ ##
#              
#         Advanced MetaSearch Engine (Version 4.0, standard)
#         --------------------------------------------------
#                     File: cgsearch.cgi
#                     All Rights Reserved 
#                   (c) CurryGuide.com, 2001.
#                 
#                Web: http://services.curryguide.com/
#                 E-Mail: support@curryguide.com
#              --------------------------------------
#   UNAUTHORISED REVIEW, USAGE, COPYING, TRANSFER or MODIFY 
#                    STRICTLY PROHIBITED.
#
#   Please read the README file (ReadMe.txt) for details on 
#                    CONDITIONS OF USAGE.
#     
#     NOTICE: DO NOT UPDATE ANY CODE ON THIS FILE. 
#
#     This script is designed with built-in support for 
#     a vast range of drop-and-use add-ons, modules that 
#     will be released from time to time either free or 
#     for sale. Any programming change or code modification
#     will almost certainly destroy its scalability.
#     MOREOVER, you are PROHIBITED by law to do so.
# ================================================================
#                                     Ref: AM4.00(std)-01-2001-SCR
use IO::Socket;use IO::Select;use IO::Handle;use vars qw($links $start_linknum $end_linknum $linkbar $link_pagenum $link_total $rawtotal $error_msg $link_perpage $total_pages $toolbox $kw_match);
#---------------------------------------------------------------------------------#
                                                                                  #
require "global_config.pl";                                                       #
                            # -- Assign FULL PATH to this above file if you get   #
                            # -- problem.                                         #
                                                                                  #
&cgx4;                                                                            #
#---------------------------------------------------------------------------------#

sub cgx4{my($cgx1,$cgx2,$cgx5,$cgx4,$cgx7,$cgx9,$cgx6,$cgx10,$cgx11,$cgx14,$cgx15,$cgx17,$cgx18,$cgx23,$cgx24,%cgx1)=&cgxg;my $cgx3='no';$cgx1=$cgx1||&cgx6();$cgx5=$cgx5||"web";my($cgx12,$cgx16,$cgx25,$cgx22,$cgx21,$cgx29,$cgx27,$cgx26);my $cgx8="";(($0=~/nph\-.*?$/)&&($cgx15 eq 'off')) and $cgx15='on';$|=1;my($cgx31,%cgx)=cgx1($cgx23,$cgx18,$cgx17);if($cgx31){$cgx3=cgx2($cgx2,$cgx15,$cgx11,$cgx14,$cgx24);print $cgx31;return;}foreach(keys %cgx){$cgx{$_}=~s/^\s+//g;$cgx{$_}=~s/\s+$//g;}$cgx{'query'}=~s/<!--(.|\n)*-->//g;$cgx{'query'}=~s/\_+/\_/g;$cgx{'query'}=~s/\ +/\ /g;$cgx25=&cgx11($cgx{'query'});(exists($cgx1{$cgx{'target'}})&&($cgx1{$cgx{'target'}} ne "")) and &cgx3($cgx{'query'},$cgx25,$cgx2,$cgx15,$cgx11,$cgx14,$cgx24,$cgx1{$cgx{'target'}}) && return;
$cgx{'where'}=$cgx{'where'}||$cgx5;$cgx{'target'}=$cgx{'target'}||$cgx{'where'};$cgx{'category'}=$cgx{'category'}||"";$cgx{'match'}=$cgx{'match'}||'all';$cgx{'to'}=$cgx{'to'}||0;$cgx{'to'}=~/\D/ and $cgx{'to'}=0;$cgx{'sr'}=$cgx{'sr'}||"o";$cgx{'pp'}=$cgx{'pp'}||"";$cgx{'sum'}=$cgx{'sum'}||"n:n";$cgx{'ss'}=$cgx{'ss'}||"";$cgx{'rtry'}=$cgx{'rtry'}||"";$cgx{'sel'}=$cgx{'sel'}||"";exists($cgx{'pg'}) or $cgx{'pg'}=1;($cgx{'pg'}=~m!\D+!) and $cgx{'pg'}=1;
$cgx{'sr'} ne 'g' and $cgx{'sr'} ne 'u' and $cgx{'sr'}='o';$cgx{'sd'}=$cgx{'sd'}||"";$cgx16=int(rand(99999999));exists($cgx{'tag'}) or ($cgx{'tag'}=$cgx16.'I'.time,$cgx8="y");$cgx{'tag'}=~/^\d+\w\d+$/ or ($cgx{'tag'}=$cgx16.'I'.time,$cgx8="y");$cgx3=cgx2($cgx2,$cgx15,$cgx11,$cgx14,$cgx24) if $cgx3 eq 'no';($cgx12,$cgx22,$cgx29)=cgx7($cgx{'query'});$cgx29=cgx5($cgx29);($cgx27=$cgx29)=~s/ /+/g;($cgx{'target'},$cgx26)=cgx9($cgx1,$cgx{'target'},$cgx5);if($cgx{'ss'} && (-e $cgx1.'/kwguard.txt')){($cgx31,$cgx22)=safe_kw($cgx17,$cgx22,$cgx1);return if $cgx31;}
$cgx21=&cgx11($cgx22);$cgx31=cgx28($cgx26,$cgx8,$cgx7,$cgx{'query'},$cgx25,$cgx21,$cgx29,$cgx27,$cgx12,$cgx16,$cgx{'to'},$cgx{'where'},$cgx{'target'},$cgx{'match'},$cgx{'pg'},$cgx{'pp'},$cgx{'tag'},$cgx{'category'},$cgx{'ss'},$cgx{'sr'},$cgx{'sd'},$cgx{'sum'},$cgx{'sel'},$cgx{'rtry'},$cgx24,$cgx1,$cgx10,$cgx17,$cgx1{'dir'});return if $cgx31;$cgx4 eq 'on' and cgx22($cgx17,$cgx10,$cgx1,$cgx{'target'});if($cgx8){$cgx{'skw'}=$cgx{'skw'}||"y"; 
(($cgx7 ne 'off')&&($cgx{'skw'} eq 'y')) and cgx25($cgx17,$cgx10,'>>'.$cgx1.'/log-keyword/'.$cgx{'target'}.'.dat',$cgx29);cgx19($cgx17,$cgx10,$cgx6,$cgx1,$cgx7,$cgx9,$cgx{'target'});}return;}sub cgx28{local($links,$linkbar,$toolbox,$kw_match,$error_msg,$start_linknum,$end_linknum,$link_pagenum,$link_total,$rawtotal,$link_perpage,$total_pages)=("","","","","",0,0,0,0,0,0,0);my($cgx12,$cgx5,$cgx29,$cgx52,$cgx19,$cgx2,$cgx21,$cgx6,$cgx74,$cgx49,$cgx37,$cgx61,$cgx55,$cgx51,$cgx27,$cgx101,$cgx85,$cgx38,$cgx91,$cgx99l,$cgx94,$cgx75,$cgx77,$cgx73,$cgx66,$cgx8,$cgx15,$cgx31,$cgx1)=@_;
my($cgx11,$cgx3,$cgx92,$cgx59,$cgx72,$cgx96,$cgx93,$cgx9,$cgx89,$cgx28,$cgx42,$cgx16);my(@cgx1)=();my $cgx24=$cgx49++;$cgx1 ne "" and ($cgx1,$cgx89)=split(/\?/,$cgx1);open (II,"<$cgx12") or &error($cgx31,'103',"trying $cgx12\. $!\.") && return "y";$cgx89=join('',<II>);close II;$cgx52=~s/\"/\&quot\;/g;$cgx89=~s/\#\#scripturl\#\#/$ENV{'SCRIPT_NAME'}/g;$cgx89=~s/\#\#directoryurl\#\#/$cgx1/g;$cgx89=~s/\#\#category\#\#/$cgx38/g;$cgx89=~s/\#\#keywords\#\#/$cgx52/g;$cgx89=~s/\#\#enckeywords\#\#/$cgx19/g;$cgx89=~s/\#\#where\#\#/$cgx61/g;
$cgx89=~s/\#\#adkeywords\#\#/$cgx6/g;$cgx89=~s/\#\#randomnum1\#\#/$cgx49/g;$cgx89=~s/\#\#randomnum2\#\#/$cgx24/g;$cgx89=~s/\#\#ss\#\#/$cgx91/g;($cgx89,$cgx28,$cgx16)=split(/<\!--CG_DATA_OUTPUT_MAP-->/,$cgx89);$|=1;print $cgx89;eval{require "$cgx8/conf/$cgx55.pl";};if($@){error($cgx31,'103',"cannot load configurations\. $@\.") && return "y";}$cgx89="$cgx55\:\:conf\:\:setting";my($cgx17,$cgx25,$cgx36,$cgx41,$cgx69,$cgx58,
$cgx67,$cgx54,$cgx43,$cgx103,$cgx78,$cgx98,$cgx56,$cgx44,$cgx83,$cgx97,$cgx22,$cgx47,$cgx65,$cgx39,$cgx46,$cgx71,$cgx57,$cgx23,$cgx68,$cgx62,$cgx95,$cgx86,$cgx48,$cgx33,$cgx99,$cgx87,$cgx18,$cgx82,$cgx88,$cgx45,$cgx64)=&$cgx89();if($cgx58 eq 'on'){for(1..90){print "<!-- ------------------------------- -->\n"; }}($cgx37 < $cgx17)?($cgx37=$cgx17):($cgx37 > 20 and $cgx37=20);(($cgx101 ne 'all')&&($cgx101=~/\D/)) and $cgx101=$cgx25;$cgx25=$cgx101||$cgx25;if($cgx52 eq ""){$error_msg=$cgx88;}elsif($cgx2 eq ""){$error_msg=$cgx45;}else{if(-e "$cgx8/storage/$cgx55$cgx85.dat"){((-e $cgx8.'/storage/'.$cgx55.$cgx85.'kw.dat')&&($cgx29 eq 'full'))and $kw_match=cgx45($cgx8.'/storage/'.$cgx55.$cgx85.'kw.dat',$cgx31);}else{$kw_match=cgx29($cgx37,$cgx66,$cgx55,$cgx29,$cgx8,$cgx15,$cgx31,$cgx54,$cgx43,$cgx2,$cgx21,$cgx87,$cgx18,$cgx82,$cgx38,$cgx25,$cgx91,$cgx74,$cgx85,$cgx51,$cgx61);}if(-e "$cgx8/storage/$cgx55$cgx85.dat"){
$cgx94?(($cgx99l eq "g")?(($rawtotal,@cgx1)=cgx12($cgx31,"$cgx8/storage/$cgx55$cgx85.dat")):(($rawtotal,@cgx1)=cgx41($cgx31,"$cgx8/storage/$cgx55$cgx85.dat"))):(($rawtotal,@cgx1)=cgx42($cgx31,"$cgx8/storage/$cgx55$cgx85.dat",$cgx99l));
my($cgx79,$cgx81)=split(/\:/,$cgx75);$link_total=$#cgx1+1;($cgx25 eq 'all')?($link_perpage=$link_total):(($cgx25=~/\D/)?($link_perpage=8):($link_perpage=$cgx25));$cgx12="query=$cgx19&where=$cgx61&target=$cgx55&match=$cgx51&con=$cgx73&ss=$cgx91&sel=$cgx77&tag=$cgx85&category=$cgx38&pp=$cgx25";if($link_total > $link_perpage){($link_pagenum,$linkbar,$total_pages)=cgx16($cgx27,$link_perpage,$cgx65,$link_total,"$ENV{'SCRIPT_NAME'}?$cgx12&sr=$cgx99l&sd=$cgx94&sum=$cgx75",$cgx39,$cgx46,$cgx71);$end_linknum=$link_pagenum*$link_perpage;$link_total < $end_linknum and $end_linknum=$link_total;}else{$link_pagenum=1;$end_linknum=$link_total;}$start_linknum=($link_pagenum-1)*$link_perpage+1;$toolbox=cgx17("$ENV{'SCRIPT_NAME'}?$cgx12&sd=$cgx94&pg=$link_pagenum",$cgx99l,$cgx81,$cgx79,$cgx57,$cgx23,$cgx68,$cgx62,$cgx95,$cgx86,$cgx48);
($cgx79 eq 'y')?(($cgx81 eq 'y')?($cgx42 = $cgx56):($cgx42 = $cgx78)):(($cgx81 eq 'y')?($cgx42 = $cgx98):($cgx42 = $cgx103));($cgx67 eq 'off')?($cgx67=""):(($cgx67 eq 'on')?($cgx67="<b>##boldkw##</b>"):($cgx67=$cgx67||""));if($cgx67){my(@cgx111)=split(/ /,$cgx21);$cgx23="";foreach(@cgx111){($cgx9=$cgx67)=~s/##boldkw##/$_/g;$cgx23.="s{$_}{$cgx9}gi,";}chop $cgx23;$cgx23=eval "sub { $cgx23 }";if($@){$cgx67="";}}$cgx36 and $cgx36.='?'.$cgx12.'&pg='.$cgx27.'&url=';$cgx41 and $cgx41 .='?'.$cgx12.'&pg='.$cgx27.'&url=';$cgx65=0;$cgx11=($end_linknum-$start_linknum)+1;if(($cgx69 eq 'on')||(!$cgx69)){$cgx69=int((($end_linknum-$start_linknum)/2)+1)||$end_linknum;}
$cgx69 eq 'off' and $cgx69=0;$cgx9=$cgx44;for($cgx49=$start_linknum;$cgx49<=$end_linknum;$cgx49++){$cgx65++;$cgx24=$cgx49-1;$links.="<center><table border=$cgx97 cellpadding=$cgx47 cellspacing=$cgx22 width=\"100%\"><tr bgcolor\=$cgx9><td>";($cgx92,$cgx59,$cgx51,$cgx72,$cgx96,$cgx93)=split(/\|/,$cgx1[$cgx24]);($cgx72,$cgx3)=cgx15($cgx72,$cgx33,$cgx96,$cgx99,);$cgx67 and ($_=$cgx72,&{$cgx23},$cgx72=$_,$_=$cgx93,&{$cgx23},$cgx93=$_,$_=$cgx3,&{$cgx23},$cgx3=$_);$cgx58=$cgx41.$cgx96;$cgx1=$cgx36.$cgx96;$_=$cgx42;s/\#\#title\#\#/$cgx72/g;s/\#\#url\#\#/$cgx96/g;s/\#\#description\#\#/$cgx93/g;s/\#\#showurl\#\#/$cgx3/g;s/\#\#source\#\#/$cgx59/g;s/\#\#number\#\#/$cgx49/g;s/\#\#translateurl\#\#/$cgx58/g;s/\#\#redirurl\#\#/$cgx1/g;s/\#\#index\#\#/$cgx24/g;s/\#\#scripturl\#\#/$ENV{'SCRIPT_NAME'}/g;
$links.=$_;$links.="</td></tr></table></center>";($cgx9 eq $cgx44)?($cgx9=$cgx83):($cgx9 eq $cgx83 and $cgx9=$cgx44);if($cgx69){unless($cgx65 % $cgx69){$links.=&interad($cgx6,$cgx21,$cgx52,$cgx19) unless($cgx65==$cgx11);}}}}else{$error_msg=$cgx64;}}$error_msg and ($error_msg=~s/\#\#keywords\#\#/$cgx52/g,$error_msg=~s/\#\#enckeywords\#\#/$cgx19/g,$_=$cgx28,s{.*?<show_error_msg>(.*?)<\/show_error_msg>.*?}{<show_error_msg>$1<\/show_error_msg>}gs||s{.*?\#\#error_msg\#\#.*?}{<show_error_msg>\#\#error_msg\#\#<\/show_error_msg>}gs,$cgx28=$_);$_=$cgx28;s{<show_(\w+)>(.*?)<\/show_(\w+)>}{${$1} ne "" and $2;}ges;s{\#\#(\w+)\#\#}{${$1}}g;print;print $cgx16;undef \&$cgx89;($cgx5 && ($cgx29 eq 'full')) and cgx25($cgx31,$cgx15,'>'.$cgx8.'/storage/'.$cgx55.$cgx85.'kw.dat',$kw_match);return "";}sub cgx29{my($cgx31,$cgx35,$cgx7,$cgx22,$cgx11,$cgx9,$cgx27,$cgx5,$cgx15,$cgx8,$cgx2,$cgx6,$cgx4,$cgx1,$cgx19,$cgx48,$cgx42,$cgx32,$cgx41,$cgx38,$cgx25)=@_;my $cgx17=$cgx11.'/engs-'.$cgx7;my $cgx44=0.250;my $cgx45=0.025;my(%cgx17);my(@cgx7);my(%cgx25);my(%cgx42);my($cgx26,$cgx21,$cgx28,$cgx23,$cgx51,$cgx34);my($cgxI,$cgx14,$cgx33,$cgx39,$cgx37);
my($cgx12,$cgx29);@cgx7=&cgx35($cgx27,$cgx17,"");@cgx7<=0 and &error($cgx27,'301',"at $cgx17, Target: $cgx7\.") && return "";eval{foreach $cgx51(@cgx7){require "$cgx17/$cgx51.pl";@{$cgx17{$cgx51}}=&{"url_$cgx51"}($cgx5,$cgx8,$cgx38,$cgx25,$cgx32,"","");}};if($@){error($cgx27,'302',"target: $cgx7 at $cgx17\. $@\.");return "n";}my $cgx46=new IO::Select;TT: foreach $cgx51(@cgx7){($cgxI,$cgx34)=cgx31($cgx17{$cgx51}[9]||$cgx44,$cgx35||"\015\012",$cgx17{$cgx51}[1],$cgx17{$cgx51}[2]||80,$cgx17{$cgx51}[3]||'http',$cgx17{$cgx51}[4],$cgx17{$cgx51}[5]||'GET',$cgx17{$cgx51}[6]||'HTTP/1.0',$cgx17{$cgx51}[7]||'Mozilla/3.0',$cgx17{$cgx51}[8]||'application/x-www-form-urlencoded');
if($cgx34 ne ""){error($cgx27,'304',"target: $cgx7 at $cgx17{$cgx51}[1]\. $cgx34\.");next TT;}$cgx46->add($cgxI);$cgx25{$cgxI}=$cgx51;}$cgx2=cgx26($cgx27,$cgx9,$cgx42,$cgx22,$cgx7,$cgx11,"$ENV{'SCRIPT_NAME'}?where=$cgx25&target=$cgx7&category=$cgx19&pp=$cgx48&ss=$cgx42&skw=n&query=",$cgx2,$cgx6,$cgx4,$cgx1);$cgx31+=time;TO: while(time<$cgx31){scalar keys %cgx25 <= 0 and last TO;@cgx7=$cgx46->can_read($cgx45);GOT: foreach $cgxI(@cgx7){exists($cgx25{$cgxI}) or next GOT;$cgx21=<$cgxI>;$cgx26="";($cgx28,$cgx23)=split / /,$cgx21;$cgx23=~/\d\d\d/ or $cgx23=299;if(!($cgx23=~/^2/)){if($cgx23=~/^30[1237]/){RD: while(defined($cgx21=<$cgxI>)){if($cgx21=~/Location:\s*(\S+)/){$cgx26=$1;last;}last if ($cgx21=~m!^\r?$!);}
$cgx46->remove($cgxI);exists($cgx42{$cgx25{$cgxI}})?($cgx42{$cgx25{$cgxI}}++):($cgx42{$cgx25{$cgxI}}=1);if($cgx42{$cgx25{$cgxI}}>=3){delete $cgx25{$cgxI};delete $cgx42{$cgx25{$cgxI}};delete $cgx17{$cgx25{$cgxI}};error($cgx27,'305',"target: $cgx7 on $cgx25{$cgxI}\.");next GOT;}if($cgx26 eq ""){error($cgx27,'307',"target: $cgx7 on $cgx25{$cgxI}\.");delete $cgx25{$cgxI};next GOT;}else{($cgx33,$cgx39,$cgx37)=&cgx33($cgx26);if($cgx33 ne ""){$cgx17{$cgx25{$cgxI}}[1]=$cgx33;$cgx17{$cgx25{$cgxI}}[2]=$cgx39||$cgx17{$cgx25{$cgxI}}[2];$cgx17{$cgx25{$cgxI}}[4]=$cgx37;}
else{$cgx17{$cgx25{$cgxI}}[4]=$cgx26;}($cgx14,$cgx34)=cgx31($cgx17{$cgx25{$cgxI}}[9]||$cgx44,$cgx35||"\015\012",$cgx17{$cgx25{$cgxI}}[1],$cgx17{$cgx25{$cgxI}}[2]||80,$cgx17{$cgx25{$cgxI}}[3]||'http',$cgx17{$cgx25{$cgxI}}[4],$cgx17{$cgx25{$cgxI}}[5]||'GET',$cgx17{$cgx25{$cgxI}}[6]||'HTTP/1.0',$cgx17{$cgx25{$cgxI}}[7]||'Mozilla/3.0',$cgx17{$cgx25{$cgxI}}[8]||'application/x-www-form-urlencoded');if($cgx34 ne ""){error($cgx27,'309',"target: $cgx7 on $cgx25{$cgxI}\. $cgx34");next GOT;}$cgx46->add($cgx14);$cgx25{$cgx14}=$cgx25{$cgxI};$cgx42{$cgx25{$cgx14}}=$cgx42{$cgx25{$cgxI}} if(exists($cgx42{$cgx25{$cgxI}}));delete $cgx25{$cgxI};last GOT;}}else{$cgx46->remove($cgxI);delete($cgx42{$cgx25{$cgxI}}) if exists($cgx42{$cgx25{$cgxI}});error($cgx27,'311',"target: $cgx7 on $cgx25{$cgxI}, Code: $cgx23\.");delete $cgx25{$cgxI};
next GOT;}}while(<$cgxI>){$cgx26.=$_;}$cgx46->remove($cgxI);($cgx29,$cgx26)=&{$cgx25{$cgxI}}($cgx25{$cgxI},$cgx17{$cgx25{$cgxI}}[10],$cgx15,"",$cgx25,$cgx26);$cgx12.=$cgx26;$cgx26="";delete $cgx17{$cgx25{$cgxI}}; delete $cgx25{$cgxI};}}if($cgx12){open(T,">$cgx11/storage/$cgx7$cgx41.dat") or &error($cgx27,'201',"make $cgx11/storage/$cgx7$cgx41.dat\. $!\.") && return "n";flock(T,2) if $cgx9 eq 'on';print T $cgx12;close T or &error($cgx27,'202',"shut $cgx11/storage/$cgx7$cgx41.dat\. $!\.") && return "n";}return $cgx2;}sub cgx31{my($cgx2,$cgx5,$cgx7,$cgx11,$cgx8,$cgx9,$cgx12,$cgx16,$cgx17,$cgx1)=@_;my($cgx6,$cgx14,$cgx4);$cgx8.='('.$cgx11.')';my $cgx18=IO::Socket::INET->new(PeerAddr=>$cgx7,PeerPort=>$cgx8,Proto=>'tcp',Type=>SOCK_STREAM,Timeout=>$cgx2) || return ("","at: $cgx7\. $!");
$cgx12 eq 'POST' and (($cgx6,$cgx14)=split(/\?/,$cgx9),$cgx4=length($cgx14));print $cgx18 join '',$cgx12,' ',$cgx9,' ',$cgx16,$cgx5,'Host: ',$cgx7,$cgx5,'Accept: text/html',$cgx5,'Accept: text/plain',$cgx5,'User-Agent: ',$cgx17,$cgx5,'Content-type: ',$cgx1,$cgx5;print $cgx18 join '','Content-Length: ',$cgx4,$cgx5,$cgx5,$cgx14 if $cgx12 eq 'POST';print $cgx18 $cgx5;return ($cgx18,"");}sub rmvgbg {my $html=shift;$html=~s/\|//g;$html=~s/\n/ /g;$html=~s/\r/ /g;$html=~s/\t//g;$html=~s/\f//g;$html=~s/\n\n//g;$html=~s/\r\r//g;$html=~s/^\s+//g;$html=~s/\s+$//g;$html=~s/\s+/ /g;$html;}sub strip{$_=$_[0];s/<[^>]*>//sg;s/[\n\r]/ /sg;s/\_+/\_/g;s/\|/:/g;s/^\s+//g;s/\s+$//g;s/\s+/ /sg;$_;}sub cgx33{my $x=shift; my($x1,$x2,$x3);($x=~m,^[fhttps]+\://([^:/]+):?(\d*)(.*),i) and (($x1,$x2,$x3)=($1,$2,$3));$x3 ||='/';$x3=~s/#.*//;$x2 ||=80;return($x1,$x2,$x3);}sub error{my $cgx2=shift||'off';my $cgx1=shift||'100';my $cgx3=shift||'not available';
$cgx2 eq 'off' and return 1;my(%cgx2)=('100'=>"Undefined Problem.",'101'=>"Method Not Allowed.",'102'=>"Safe-Search Problem.",'103'=>"Template Problem.",'105'=>"Config Load Problem.",'109'=>"Read Problem.",'110'=>"Read Problem.",'201'=>"Data Keeping Problem.",'202'=>"Data Closing Problem.",'301'=>"No Engine-Module.",'302'=>"Module Load Problem.",'303'=>"Surprise Surprise.",'304'=>"Connection Problem.",'305'=>"Too Many Redirections.",'307'=>"Redirection Problem.",'309'=>"Redirect Connect Problem.",'311'=>"Unknown Host Response.",'315'=>"Connection Timeout.",'316'=>"Closing data receive channel\.",
'319'=>"Partial content\.",'311'=>"Unknown Host Response.",'331'=>"Redirection Detected.",'401'=>"Log dir missing.",'402'=>"Logging Problem.",'403'=>"Logging Problem.",'405'=>"No File\.",'406'=>"Closing Problem\.",'407'=>"Closing Problem\.",'409'=>"Cache Cleaning Problem\.",'410'=>"Cache Cleaning Problem\.",'411'=>"Cache Cleaning Problem\.",'412'=>"Cache Problem\.",'414'=>"Cache Problem\.",'417'=>"Cache Problem\.",'418'=>"Cache Problem\.",'421'=>"Cache Problem\.",'422'=>"Cache Problem\.",'424'=>"Cache Problem\.",'426'=>"Cache Problem\.",'427'=>"Cache Problem\.",'429'=>"Cache Problem\.",'430'=>"Cache Problem\.",'432'=>"Cache Problem\.",
'433'=>"Cache Problem\.",'441'=>"Mod-List Problem\.",'442'=>"Mod-List Problem\.",'447'=>"ES Problem\.",'448'=>"ES Problem\.",'501'=>"Keyword Roulette Problem\.",'503'=>"Keyword Roulette Problem\.",'505'=>"Keyword Roulette Problem\.",'506'=>"Keyword Roulette Problem\.",'507'=>"Keyword Roulette Problem\.",'509'=>"Keyword Roulette Problem\.",'510'=>"Keyword Roulette Problem\.",'601'=>"Dir Problem\.",'602'=>"Dir Problem\.");
$cgx2=$cgx2{$cgx1}||"Undefined";print "<p><dl><dt><font color=\"ff0000\"><b>Problem Code ",$cgx1,":</b> ",$cgx2,"</font><dd><font color=\"ff0000\"><b>Reason:</b> ",$cgx3,"</font></dd></dt></dl></p>";return 1;}sub cgx26{my($cgx2,$cgx5,$cgx8,$cgx12,$cgx21,$cgx11,$cgx9,$cgx7,$cgx6,$cgx3,$cgx1)=@_;$cgx12 eq 'full' or return "";$cgx7 or return "";
$cgx12=$cgx11.'/log-keyword/'.$cgx21.'.dat';(-e $cgx12) or cgx25($cgx2,$cgx5,'>'.$cgx12,$cgx7) && return "";my($cgx26,$cgx29,$cgx24,@cgx12);my($cgx14,%cgx11);my(@cgx21)=split(/ /,$cgx7);$cgx3=$cgx3||4;$cgx1=$cgx1||2;my $cgx22=($cgx3*$cgx1);$cgx9.='##enckw##';$cgx6=~s/##kwmatchurl##/$cgx9/g;$cgx9='';foreach(@cgx21){$cgx9.="m/\Q$_\E/o||";}
@cgx21=();$cgx9=~s/..$//;$cgx9=eval "sub{$cgx9}";if($@){&error($cgx2,'503',"Inappropriate input value\. $@\.");return "";}open(K,"<$cgx12") or error($cgx2,'501',"read problem with $cgx12\. $!\.") && return ""; OP: while(<K>){/^$/ and next OP;$cgx14=0;chomp;if($cgx14=$cgx14||&{$cgx9}){$cgx11{$_}=$_ unless(($_ eq $cgx7)||exists($cgx11{$_}));scalar keys %cgx11 >= $cgx22 and last OP;}}close K or &error($cgx2,'505',"shut problem with $cgx12\. $!\.") && return "";$cgx11.='/kwguard.txt';if($cgx8 && (-e $cgx11)){%cgx11=cgx23($cgx2,$cgx11,%cgx11);}foreach(keys %cgx11){push(@cgx21,$_);}
undef (%cgx11);chomp(@cgx21);$cgx22 > @cgx21 and $cgx22=@cgx21;$cgx22 <= 0 and return "";$cgx14=int(100/$cgx3);for($cgx26=1;$cgx26<=($cgx3-1);$cgx26++){push(@cgx12,$cgx14);}
push(@cgx12,(100-($cgx14*($cgx26-1))));$cgx1=int((($cgx22-1)+$cgx3)/$cgx3);$cgx9=qq~<center><table cols=$cgx3 border=0 cellpadding=3 cellspacing=0 width="100%">
~;OO: for($cgx29=0;$cgx29<=($cgx1-1);$cgx29++){$cgx9.=qq~<tr>~;OI: for($cgx26=0;$cgx26<=($cgx3-1);$cgx26++){$cgx24=$cgx29+$cgx26*$cgx1;if($cgx21[$cgx24]){$_=$cgx6;s/##kwmatch##/$cgx21[$cgx24]/g;$cgx21[$cgx24]=~s/ /+/g;s/##enckw##/$cgx21[$cgx24]/g;$cgx9.=qq~<td width="$cgx12[$cgx26]%" valign="top">$_</td>~;}else{$cgx9.=qq~<td width="$cgx12[$cgx26]%" valign="top">&nbsp;</td>~;}}$cgx9.=qq~</tr>~;}$cgx9.=qq~</table></center>~;return $cgx9;}
sub cgx45{my $cgx1=shift||return "";my $cgx3=shift||'off';my $cgx2="";open(SK,"<$cgx1") or &error($cgx3,'506',"problem reading cached kw: $cgx1\. $!\.") && return "";$cgx2=join('',<SK>);close(SK) or &error($cgx3,'507',"problem shutting cached kw: $cgx1\. $!\.") && return "";return $cgx2;}sub cgx25{my($cgx4,$cgx1,$cgx2,$cgx5)=@_;$cgx2 or error($cgx4,'405',"No file exists: $cgx2\.") && return 1;$cgx5 or return 1;open(FS,"$cgx2") or error($cgx4,'406',"File creation fail: $cgx2\. $!\.") && return 1;flock(FS,2) if $cgx1 eq 'on';print FS "$cgx5\n";close(FS) or error($cgx4,'407',"File close fail: $cgx2\. $!\.") && return 1;return 1;}sub cgx23{my($cgx4,$cgx1,%cgx2)=@_;
scalar keys %cgx2 <= 0 and return "";my $cgx2=',';my(%cgx4);my($cgx7,@cgx1);open(IIX,"<$cgx1") or error($cgx4,'509',"kwguard file $cgx1\. $!\.") && return "";CI: while(<IIX>){/^$/ and next CI;/^#/ and next CI;chomp;$cgx7.=$_;}close IIX or error($cgx4,'510',"kwguard file $cgx1\. $!\.") && return "";$cgx7=lc($cgx7);OC: foreach $cgx4(keys %cgx2){@cgx1=split(/ /,$cgx2{$cgx4});$cgx1="y";IC: foreach(@cgx1){$cgx7=~/$cgx2$_/ and ($cgx1="",last IC);}$cgx1 and $cgx4{$cgx2{$cgx4}}=$cgx2{$cgx4};}return(%cgx4);}sub cgx22{my($cgx1,$cgx2,$cgx,$cgx4)=@_;$cgx.='/log-count/'.&cgx21.'.txt';$cgx or error($cgx1,'401',"Target: $cgx4\.") && return;
(-e $cgx) or cgx25($cgx1,$cgx2,'>'.$cgx,1) && return;open(XV,"+<$cgx") or error($cgx1,'402',"target: $cgx4\. $! $cgx\.") && return;flock(XV,2) if $cgx2 eq 'on';my $cgx5=<XV>;chomp $cgx5;$cgx5++;seek(XV,0,0);print XV $cgx5;close XV or &error($cgx1,'403',"target: $cgx4\. $! $cgx\.");return;}sub cgx21 {my(@cgx)=("January","February","March","April","May","June","July","August","September","October","November","December");my($cgx,$cgx1)=(localtime(time))[4,5];$cgx1+=1900;return($cgx[$cgx].'_'.$cgx1);}sub cgx19{my($cgx2,$cgx5,$cgx1,$cgx8,$cgx9,$cgx3,$cgx12)=@_;$cgx1=$cgx1||3600;$cgx1=~/\D/ and $cgx1=3600;$cgx1 < 10 and $cgx1=3600;
my $cgx7=$cgx8.'/storage/.ctimer.dat';my($cgx6,$cgx14,$cgx15);my $cgx11=time;(-e $cgx7) or cgx25($cgx2,$cgx5,'>'.$cgx7,$cgx11) && return;open(C1,"+<$cgx7") or error($cgx2,'409',"Cache timer read fail\. $!\.") && return;flock(C1,2) if $cgx5 eq 'on';$cgx6=<C1>;chomp $cgx6;if(($cgx11-$cgx6)<=$cgx1){close(C1) or error($cgx2,'410',"Cache timer closing fail\. $!\.") && return;return;}else{seek(C1,0,0);print C1 $cgx11;close(C1) or &error($cgx2,'411',"Cache timer update fail\. $!\.") && return;}$cgx14=$cgx8.'/storage';opendir(S1,$cgx14) or error($cgx2,'412',"Cache read fail: $cgx14\. $!\.") && return;CH: while($cgx7=readdir S1){$cgx7=~m/^\./o and next CH;$cgx7=~m{^.*?\d+\I(\d+)\.dat$}o and $cgx15=$1;
if(($cgx11-$cgx15)>$cgx1){unlink "$cgx14/$cgx7";}}closedir(S1) or error($cgx2,'414',"Cache close fail: $cgx14\. $!\.") && return;$cgx9 eq 'off' and return;$cgx7=$cgx8.'/log-keyword/'.$cgx12.'.dat';$cgx11=0;$cgx14="";open(K1,"<$cgx7") or &error($cgx2,'417',"KW Cache read fail: $cgx7\. $!\.") && return;while(sysread K1,$cgx14,1024){$cgx11+=($cgx14=~tr/\n//);}close K1 or error($cgx2,'418',"KW Cache close fail: $cgx7\. $!\.") && return;$cgx3=$cgx3||500;($cgx11>$cgx3)?($cgx11-=$cgx3):(return);$cgx14=$cgx8.'/log-keyword/tmp_'.$cgx12.'.dat';if(-e $cgx14){error($cgx2,'421',"exists tmp KW: $cgx14\.");unlink $cgx14 or &error($cgx2,'422',"existing tmp purge fail KW: $cgx14\.");}
$cgx11++;$cgx6=0;open(K2,">$cgx14") or error($cgx2,'424',"tmp KW write fail: $cgx14\. $!\.") && return;flock(K2,2) if $cgx5 eq 'on';open(K3,"<$cgx7") or &error($cgx2,'426',"KW Cache read fail: $cgx7\. $!\.") && return;flock(K3,2) if $cgx5 eq 'on';KL: while(<K3>){/^$/ and next KL;$cgx6++;$cgx6 < $cgx11 and next KL;print K2 $_;}close (K3) or &error($cgx2,'427',"KW close fail: $cgx7\. $!\.");close(K2) or error($cgx2,'429',"tmp KW close fail: $cgx14\. $!\.") && return;
unless(rename($cgx14,$cgx7)){error($cgx2,'430',"tmp KW rename not supported using remove and fail: $cgx14\.");unlink $cgx7 or &error($cgx2,'432',"trouble with tmp KW. Cannot purge for alternate rename: $cgx7\. $!\.");rename($cgx14,$cgx7) or &error($cgx2,'433',"trouble with KW rename: $cgx14\.");}}sub cgx17{my($cgx15,$cgx14,$cgx12,$cgx11,$cgx9,$cgx7,$cgx6,$cgx5,$cgx4,$cgx3,$cgx2)=@_;my $cgx1;if($cgx11 eq "y"){$cgx1=qq~<a href="$cgx15&amp;sr=$cgx14&amp;sum=n:$cgx12">$cgx7</a>&nbsp;~;}else{$cgx1=qq~<a href="$cgx15&amp;sr=$cgx14&amp;sum=y:$cgx12">$cgx6</a>&nbsp;~;}if($cgx12 eq "y"){$cgx1.=qq~$cgx9&nbsp;<a href="$cgx15&amp;sr=$cgx14&amp;sum=$cgx11:n">$cgx5</a>&nbsp;~;}else{$cgx1.=qq~$cgx9&nbsp;<a href="$cgx15&amp;sr=$cgx14&amp;sum=$cgx11:y">$cgx4</a>&nbsp;~;}
if($cgx14 eq "g"){$cgx1.=qq~$cgx9&nbsp;<a href="$cgx15&amp;sr=o&amp;sum=$cgx11:$cgx12">$cgx3</a>~;}else{$cgx1.=qq~$cgx9&nbsp;<a href="$cgx15&amp;sr=g&amp;sum=$cgx11:$cgx12">$cgx2</a>~;}$cgx1;}sub cgx16{my($cgx11,$cgx5,$cgx4,$cgx9,$cgx12,$cgx14,$cgx18,$cgx3)=@_;my($cgx6,$cgx7,$cgx19,$cgx2,$cgx1);$cgx3=$cgx3||' ';(($cgx9 % $cgx5)==0)?($cgx1=int($cgx9/$cgx5)):($cgx1=int($cgx9/$cgx5)+1);($cgx11>$cgx1) and $cgx11=$cgx1;if($cgx1<=$cgx4){$cgx6=1;$cgx7=$cgx1;}else{($cgx11>1)?($cgx6=$cgx11-1):($cgx6=$cgx11);($cgx11<$cgx1)?($cgx7=$cgx11+1):($cgx7=$cgx11);while(($cgx7-$cgx6)<=($cgx4-2)){((($cgx11-$cgx6)>0)&&($cgx6>1)) and $cgx6--;((($cgx7-$cgx11)>0)&&($cgx7<$cgx1)) and $cgx7++;}}for $cgx19($cgx6..$cgx7){if($cgx19==$cgx11){($cgx19==$cgx7)?($cgx2.=qq~<big>$cgx19</big>~):($cgx2.=qq~<big>$cgx19</big> $cgx3 ~);}elsif($cgx19==$cgx7){$cgx2.=qq~<a href="$cgx12&amp;pg\=$cgx19">$cgx19</a>~;}else{$cgx2.=qq~<a href="$cgx12&amp;pg\=$cgx19">$cgx19</a> $cgx3 ~;}}(($cgx14 ne "")&&($cgx11>$cgx6))?($cgx5=$cgx11-1 and $cgx14=qq~<a href="$cgx12&amp;pg\=$cgx5">$cgx14</a>&nbsp;$cgx3$cgx3&nbsp;~):($cgx14='');(($cgx18 ne "")&&($cgx11<$cgx7))?($cgx5=$cgx11+1 and $cgx18=qq~&nbsp;$cgx3$cgx3&nbsp;<a href="$cgx12&amp;pg\=$cgx5">$cgx18</a>~):($cgx18='');$cgx2=$cgx14.$cgx2.$cgx18;return($cgx11,$cgx2,$cgx1);}sub cgx15{my($cgx6,$cgx2,$cgx5,$cgx1)=@_;length($cgx5) > $cgx1 and $cgx5=substr($cgx5,0,($cgx1-3))."...";length($cgx6) > $cgx2 and $cgx6=substr($cgx6,0,($cgx2-3))."...";return($cgx6,$cgx5);}
sub cgx12{my($x5,$x1)=@_;my @x2;open(IXI,"<$x1") or &error($x5,'109',"file: $x1\. $!\.") && return();@x2=<IXI>;close IXI or &error($x5,'110',"file: $x1\. $!\.") && return ();$x1=@x2;return($x1,@x2);}sub cgx41{my($x1,@x1)=cgx12($_[0],$_[1]);@x1=cgx44(@x1);return($x1,@x1);}sub cgx44{my(@x2)=@_;my($x3,@x1,%x3,@x3,$x5);my $x4=-1;my(%x2)=();IX: for($x5=0;$x5<@x2;$x5++){($x2[$x5]=~/(.*?)\|.*?/o)?($x3=$1):(next IX);$x3{$x3}=$x3 unless exists($x2{$x3});push(@{$x2{$x3}},$x5);}if($_[0]){my @x6=split(/ /,$_[0]);foreach $x3(@x6){exists($x3{$x3}) and push (@x3,$x3) and delete $x3{$x3};}}foreach $x3(keys %x3){push(@x3,$x3{$x3});}foreach $x3(keys %x2){if($#{$x2{$x3}}>$x4){$x4=$#{$x2{$x3}};}}for($x5=0;$x5<=$x4;$x5++){foreach $x3(@x3){push(@x1,$x2[${$x2{$x3}}[$x5]]) if($x5<=$#{$x2{$x3}});}}return(@x1);}sub cgx42{my($x21,$x9,$x2)=@_;my($x1,%x5,@x8);my($x3,@x3,@x4,@x2,%x7);my($x11,@x6)=cgx12($x21,$x9);@x6=cgx44(@x6) unless $x2 eq 'g';CK: for($x1=0;$x1<=$#x6;$x1++){@x2=split(/\|/,$x6[$x1]);$x3=lc($x2[4]);
$x3=$x2[0].$x3 if $x2 eq 'g';if(exists($x7{$x3})){@x3=split(/\|/,$x4[$x7{$x3}]);if($x3[0]=~/$x2[0]/){next CK;}$x3[0].=','.$x2[0];$x3[1].=', '.$x2[1];$x5{$x7{$x3}}+=1;
$x4[$x7{$x3}]=join('|',@x3);}else{push(@x4,$x6[$x1]);$x7{$x3}=$#x4;}}if(scalar keys %x5 > 0){undef @x6;@x8=sort{$x5{$b}<=>$x5{$a}} keys %x5;foreach(@x8){push(@x6,$x4[$_]);}
for($x1=0;$x1<=$#x4;$x1++){unless(exists($x5{$x1})){push(@x6,$x4[$x1]);}}return($x11,@x6);}else{return ($x11,@x4);}}sub cgx11{$_=$_[0]||return"";s/\%/%25/g;s/</%3C/g;s/>/%3E/g;s/\?/%3F/g;s{/}{%2F}g;s/\:/%3A/g;s/;/%3B/g;s/\'/%27/g; s/\"/%22/g;s/\+/%2B/g;s/=/%3D/g;s/\|/%7C/g;s/\\/%5C/g;s/\$/%24/g;s/\&/%26/g;s/\#/%23/g;s/\`/%60/g;s/\~/%7E/g;s/\!/%21/g;s/\^/%5E/g;s/\(/%28/g;s/\)/%29/g;s/ /+/g;$_;}sub cgx9{my($cgx6,$cgx3,$cgx1)=@_;$cgx6 and $cgx6.='/';my $cgx4=$cgx6.'engs-';(-d $cgx4.$cgx3) or $cgx3=$cgx1;$cgx6.='template/';(-e $cgx6.$cgx3.'.html')?($cgx6.=$cgx3.'.html'):((-e $cgx6.$cgx1.'.html')?($cgx6.=$cgx1.'.html'):($cgx6.='web.html'));return($cgx3,$cgx6);}
sub cgx7{my $cgx3=lc($_[0])||return (0,"","");my($cgx2,$cgx1,@cgx1,@cgx3);my $cgx4="";$cgx2=($cgx3=~/[+-]\w+/)||($cgx3=~/\".*?\"/)||($cgx3=~/\s(and|or|not)\s\w/)||0;
$cgx2 and $cgx1=$cgx3;$cgx3=~s/[\(\)\]\[]//g;@cgx3=('where \w+ i \w+ (.*?)','what \w+ (.*?)','who \w+ (.*?)','how \w+ (.*?)','when (.*?)','show me (.*?)','help \w\w (.*?)','do i (.*?)','do we (.*?)');my $cgx9=' i me we they them you she find sites a an am are were has had be been about on the and or of from in at to for out over shall will some ';II: foreach(@cgx3){if($cgx3=~s/$_/$1/){$cgx4="y";$cgx3=~s/(.*?)\W+$/$1/;last II;}}if($cgx4){my(@cgx1)=split (/ /,$cgx3);$cgx3="";foreach(@cgx1){unless($cgx9=~/ $_ /){$cgx3.="$_ ";}}}$cgx3=~s/^[\w\W] //g;$cgx3=~s/ [\w\W]$//g;$cgx3=~s/ [\w\W] / /g;$cgx3=~s/ \W+ / /g;$cgx3=~s/^\W+ //;$cgx3=~s/ \W+$//;$cgx3=~s/^\W+$/ /g;$cgx3=~s/^\s+//g;$cgx3=~s/\s+$//;$cgx3=~s/\s+/ /g;
($cgx3=~/^$/)||($cgx3 eq 'and')||($cgx3 eq 'or')||($cgx3 eq 'not')||($cgx3 eq 'web') and return "";$cgx2 or $cgx1=$cgx3;return($cgx2,$cgx1,$cgx3);}sub cgx5{local $_=shift||return "";my $cgx9=';"$,:\';*+^!%|&`¬><?\/=\\#~';s/[$cgx9]//g;s/ [\w\W]$//g;s/ [\w\W] / /g;$_;}sub cgx6{local $_=$ENV{'SCRIPT_FILENAME'};s/(.*)\/.+$/$1/;$_;}
sub cgx1{my $x1=shift||150;my $x2=shift||'GETPOST';my(@x1,%x2);my($x3,$x4,$x5);$x2=~/$ENV{'REQUEST_METHOD'}/ or return ("<p><dl><dt><font color=\"ff0000\"><b>Problem Code 101:</b> Request Method Not Allowed.</font><dd><font color=\"ff0000\"><b>Report:</b> you are using Request Method $ENV{'REQUEST_METHOD'}\.</font></dd></dt></dl></p>","");if($ENV{'REQUEST_METHOD'} eq 'GET'){@x1=split(/&/,$ENV{'QUERY_STRING'});}elsif($ENV{'REQUEST_METHOD'} eq 'POST'){read(STDIN,$x3,$ENV{'CONTENT_LENGTH'});@x1=split(/&/,$x3);$x3="";}else{return "";}XOA: foreach $x3(@x1){($x4,$x5)=split(/=/,$x3);$x5=~tr/+/ /;$x5=~s/%([a-fA-F0-9][a-fA-F0-9])/pack("C",hex($1))/eg;($x5 eq "") and next XOA;length($x5)>$x1 and $x5=substr($x5,0,$x1);if(exists($x2{$x4})){$x2{$x4}.=",$x5";}else{$x2{$x4}=$x5; }}return("",%x2);}sub cgx3{my($Original_Keywords,$Encoded_Keywords,$x1,$x2,$x3,$x4,$x5,$x7)=@_;$x7=~s/\#\#enckeywords\#\#/$Encoded_Keywords/g;if($x2 eq 'on'){$x2=cgx2($x1,$x2,$x3,$x4,$x5);print qq~<HTML>
<HEAD><META HTTP-EQUIV="Refresh" Content="0; URL=$x7">
<TITLE>Please wait.... Searching for: $Original_Keywords</TITLE>
</HEAD>
<BODY BGCOLOR="FFFFFF">
<p>&nbsp;<blockquote><p>Searching for <a href="$x7">$Original_Keywords</a>, <BR>Please wait....</blockquote></BODY></HTML>
~;}else{print "Location: $x7$x5$x5";}return 1;}sub cgx2{my($cgx1,$cgx2,$cgx4,$cgx5,$cgx6)=@_;$cgx2 eq 'on' and print $cgx1," 200 OK",$cgx6;$cgx4 eq 'on' and print "Pragma: no-cache",$cgx6;$cgx5 ne 'off' and print $cgx5;print "Content-type: text/html",$cgx6,$cgx6;return 'yes';}sub cgx35{my($cgx1,$cgx3,$cgx2)=@_;my(@cgx1,@cgx2,%cgx2);opendir(MOD,$cgx3) or error($cgx1,'601',"dir: $cgx3\. $!\.") && return ();@cgx2=readdir(MOD);chomp @cgx2;closedir MOD or error($cgx1,'602',"dir: $cgx3\. $!\.") && return ();foreach(@cgx2){/^\./ and next;/(.*?)\.pl$/ and $cgx2{$1}=$1;}if($cgx2){@cgx2=split(/,/,$cgx2);foreach(@cgx2){exists($cgx2{$_}) and push (@cgx1,$_) and delete $cgx2{$_};}} foreach (keys %cgx2){push(@cgx1,$cgx2{$_});}return @cgx1;}
##_______________________________________________________________________##END
# Ref: AM4.00(std)-01-2001-SCR
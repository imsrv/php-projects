#!/usr/bin/perl
$| = 1;

use Net::DNS;
use Socket;
srand();

# Max. time to stop trying to connect to server
$TIMEOUT = 10;

# Max. lines to show on screen at one time
$max_lines = 10;

# Where to store valid e-mail addresses
# Eg. /path/to/store/emails/
$save_dir = "!SAVEDIR!/";

#############################################
# DO NOT EDIT BELOW THIS LINE
# THIS SCRIPT HAS BEEN SCRAMBLED
# MODIFYING ANYTHING BELOW MAY DISABLE IT
# PROVIDED BY CGICONNECTION.COM
#############################################



  # [#
                   ## y# ÊRPM# ﬁ◊—ê# ˚b‹### ‹# @≤˙# √ Yv### Û˙5# # qÃ•#
                 # ##### Œ# ƒ'âÏ#### îü## g# áNV# #
          # e™≈### ´o## #### ’å¨####
               # A# Í,|R# å®# ÿÇ### sã∂###
# Èprõ## #### Lû%å###### \Ê# àX^## ‚#

#### Ba### # œIn# «Ñ#### à#
                  ## Æ¯0## s## j¢É# ####
               ##  ß## # 2n# ı### %K˚x# ; ###
                  #
        # bs# ‚C### #
        ## œñ## p¯Ü¶# ## E L#
      # ˚2˚#### Ú#### 4˙I# # ˚ºﬂI### ¥P## A–ù# ≥##
                # ######
        ## —## ´°”####### uœ# q6### (ÙÅ####
                  #### "Û###
   # ´#
          ##### ####
                  # Q# ¸;Í# ÊTπÚ## Û### # A# zj≈# ó###
             ### e####
         # # ∏##
$peeJLin = $TIMEOUT;$SJwAwytxf = $max_lines;$hSyBpc = "$save_dir";&kfdwGdME;
$ANRtlVlSa = int(rand(10000000000));$cYFXDQDy = $GuHjk{'email'};##### Û #
           # 1;Ö##### ∫H# §wN# Ù## Z˙# #
               # ’### –ó'I#### =K∫<# Kç# r# â)ö####
                ####### ## # # 	wr# º¶d∑# â## Q3"# ##
$WIrHwLZT = $GuHjk{'area'};
$pdFdoqDv = "verify\.$ANRtlVlSa\.$$";$SIG{ALRM} = \&UcTRusGRf;
if ($WIrHwLZT eq "download"){&pLBvHxWbJ;exit;}$fJwIuTa = 1;$ScXpYumGE = 0;
print "Content-type: text/html\n\n";if ($WIrHwLZT eq ""){&VyPBQ;exit;}
&YEQIpI;for ($aRKWRNhD = 0; $aRKWRNhD < 50; $aRKWRNhD++){
print "<!-- FORCE OUTPUT -->\n";}$cYFXDQDy =~ s/\cM/\n/g;
splice(@iwBvIP, 0);@iwBvIP = split(/\n/, $cYFXDQDy);
for ($aRKWRNhD = 0; $aRKWRNhD < @iwBvIP; $aRKWRNhD++){
splice(@dIiaSJWMS, 0);$cYFXDQDy = @iwBvIP[$aRKWRNhD];
@dIiaSJWMS = split(/\@/, $cYFXDQDy);
if ($cYFXDQDy ne "" and $cYFXDQDy =~ /^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,3}|[0-9]{1,3})(\]?)$/)
{$fJwIuTa = 1 if $fJwIuTa > $SJwAwytxf;
print "<SCRIPT>document.verify.loc$fJwIuTa.value = '>>';</SCRIPT>\n";
print "<SCRIPT>document.verify.email$fJwIuTa.value = '$cYFXDQDy';</SCRIPT>\n";
$ltSAL = @dIiaSJWMS[0];$ddnKJI = @dIiaSJWMS[1];eval {alarm($peeJLin);
$oRpWSx = &SwfcWWQ($ddnKJI);                ### ¨88ñ## Ñ¢##### ái…# «# rﬂ>### îr∆##
                # œ˘# # # 9§# ;### BÀ#  ##
        # Ï˜## WA@# ˘7#
alarm(0); };if ($@ =~ /^TIMEOUT/){
&VdtsSM($fJwIuTa, "DNS Timed Out");}elsif($oRpWSx == -1){
&VdtsSM($fJwIuTa, "DNS Failed");}else{eval {alarm($peeJLin);
$hhpHQl = &STouU($oRpWSx, $cYFXDQDy);    # √# G' #
      # Xì˜# 2é…## ### È# ## ΩÌä### ƒı÷## ÜÛ<# ò≤# -8# Ë˚##
     # ## ˜## P##
&VdtsSM($fJwIuTa, "$hhpHQl");
alarm(0); };if ($@ =~ /^TIMEOUT/){&VdtsSM($fJwIuTa, "Verify Timed Out");         ### ˘!)# ‚### Õ´## ## P# 6ñ# ©v###
               ## # À###
   ### ﬁ‚x# æ?¬## jà# ◊##### # ZJ=##
# # ## F/Û# ≈##
                ###
                 # í# (#  A## ÃÃ#### o¶™# kË# ªEê## #
       # ## # Ä.#### kz,## h¬####
        ####### # ’# Ì# ÊA◊≈### C|###
 ### R### Ä[# ù### |e# t### æ√## ⁄Í##
}}$fJwIuTa++;$YViPO = $fJwIuTa - 1;
print "<SCRIPT>document.verify.loc$YViPO.value = '';</SCRIPT>\n";   # ## ‡Ì## ä÷˘## í˙K# £g˘Q# ®##
        # ç3≥### ###### }###
      #
                  # ≤÷T#### Â∞…# ## µÂ;$#
}}exit;
sub STouU  {my ($nvrPtHrk, $cYFXDQDy) = @_;
$nvrPtHrk =~ s/^\s+//g; # remove spaces around $nvrPtHrk

$nvrPtHrk =~ s/\s+$//g;my($BEMxfHS) = (getprotobyname('tcp'))[2];         # ¡8# ™H# ;# 8˘{˙# ∑#### ## ## ´### ˆ~Y# BåÃ# ôlÍQ# ®#
   # ò]_##### # w6# zçu8### # ñP⁄## X∏“#
## Ì## ## ## :î# # B∫#### ¢î⁄# …õ# #
    ## ### Ï#### ™#### # # ﬁ####

my($rmZiJZN) = (getservbyname('smtp', 'tcp'))[2];
my($xNCABuIg) = ($nvrPtHrk =~
/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/)? pack('C4',$1,$2,$3,$4)
: (gethostbyname($nvrPtHrk))[4];if (!defined($xNCABuIg)){
return("Failed connect to $nvrPtHrk: 1");}
if (!socket(MAIL, AF_INET, SOCK_STREAM, $BEMxfHS)){
return("Failed connect to $nvrPtHrk: 2");}
if (!connect(MAIL, pack('Sna4x8', AF_INET, $rmZiJZN, $xNCABuIg))){
return("Failed connect to $nvrPtHrk: 3");}my($iEjloa) = select(MAIL);      ## -I####### eY######
         # Ófÿ{# XK# # #
## õc#
 # ¸# #
 # Ç¥√## ü## ## –# t# çÃ7## ©kE# # Ç=Ô# óØü# ó_‚##
      #### # Wã## ë∑###
$| = 1;select($iEjloa);         #
                 ### ## ’<M# ## ## ### ¥## ##
               #
    #
                 ## 7#####
$_ = <MAIL>;if (/^[45]/){close(MAIL);
return("Error 4: $_");}print MAIL "HELO $nvrPtHrk\r\n";while($_ =~ /220/){
$_ = <MAIL>;if (/^[45]/){close(MAIL);return("Error 5: $_");}}
print MAIL "MAIL FROM:<>\r\n";$_ = <MAIL>;if (/^[45]/){close(MAIL);
return("Error 6: $_");}print MAIL "RCPT TO: <$cYFXDQDy>\r\n";                  # Ñ# ﬁ## $# "°### Ï# ˙V∏ß# ##### ˙4#
              ##
        # S9 ## •# `Q# >;## ##### 8Eœ # e˛˜W###
          # j»####### Æ## ####
                  #### ™ç# #### # ####### Y¨÷# ô# *-#
              # |## #### )–Öï#
              # ﬂÒ #
        # d4# |# „«u## î## ≥‡# ñ## ##
$_ = <MAIL>;if (/^[45]/){
close(MAIL);return("User unknown");}else { $IkGaCAkJ = $_ };    #### # !,# ∆## ÌÈ####
                # '%.# ### Ã## ib_# ¶Y# U√#### #
print MAIL "QUIT\r\n";        # ‡#### # ##
     ## ï.#### ]≤# Ì˘##
        ## ö### (É#### °À## á# ãÈ## mÙ##
          # +º…#  ›### Ù###
$_ = <MAIL>;if (/^[45]/){close(MAIL);
return("Error 7: $_");}close(MAIL);open(FILE, ">>$hSyBpc$pdFdoqDv");
print FILE "$cYFXDQDy\n";close(FILE);$ScXpYumGE++;
print "<SCRIPT>document.verify.valid.value = '$ScXpYumGE';</SCRIPT>\n";                   ### ∞“#### ç≥“## éË≈#### 4# ## £ÁÁÀ#

return("VALID");}sub SwfcWWQ{my($GqcdwFWb) = @_[0];my($WwQHfWyoF);
$ZggCGy = Net::DNS::Resolver->new();    # ¬# çı# @ñT|## +Â# # ## œ]ˆ### »¯ìâ#
## ### ≤sÿ*## ˆº# –^# gÎˆ#### #### ﬁH###

$WwQHfWyoF = $ZggCGy->search("$GqcdwFWb");if (!$WwQHfWyoF){return(-1);}
@XCgFflpT = mx($ZggCGy, $GqcdwFWb) or return($GqcdwFWb);#### %# Ã⁄## ˆâk#
                ## 8a## àÖW## A#

foreach $jPoRTUvj (@XCgFflpT){return($jPoRTUvj->exchange);}}sub kfdwGdME {
if ("\U$ENV{'REQUEST_METHOD'}\E" eq 'GET') {
@DVkAdI = split(/&/, $ENV{'QUERY_STRING'});             # Êÿ### √## n°}ì# Ûÿx# ¨‚#
      # õ# a# ãÚ&p### l˙# # UàÜ### ¸Áä# b### b‹3# qJvΩ#
    # ùY„# U•#
}
elsif ("\U$ENV{'REQUEST_METHOD'}\E" eq 'POST') {
read(STDIN, $YZeuOs, $ENV{'CONTENT_LENGTH'});
@DVkAdI = split(/&/, $YZeuOs);}else {&PyjndTLnZ('request_method');}
foreach $FtrTtln (@DVkAdI) {($qlpCgv, $iPHrG) = split(/=/, $FtrTtln);
$qlpCgv =~ tr/+/ /;
$qlpCgv =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg;       ##
            ####### ÕÑ“###
        # ≈# Ù# ?# _9¶¡# j≠„## # ˛dÁ~###
    ## ïp### ## ### ‡x# # c###

$iPHrG =~ tr/+/ /;
$iPHrG =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg;
$iPHrG =~ s/<!--(.|\n)*-->//g;                  # ### Ω;### ~# NBŒ### ¯Ë,«#
        # ò•˙# # q£œ)# F## ÇI####
                ## À## ∂# ##
      ##  ####
     #### ç!## ## ## a## äèw#### q#
        # # #
       # #
         # ≈# Î?## ªÌ### ########## # R##
            ### #®Xí### +###### áπw#
$YUvrF = 1;if ($YUvrF == 0){
$iPHrG =~ s/<([^>]|\n)*>//g;        ## bÀ# mnã# v8## ‘©## á# ÜVT###
     ### ¨# ä´-## ƒ# ÔØ# ∫QA# ª∏ΩΩ# EI0# ±# IQÔÎ# ™âê## Ås###
  ## S# # # Ò# ©# Ω# ®# $# K##
}if ($GuHjk{$qlpCgv} && ($iPHrG)) {
$GuHjk{$qlpCgv} = "$GuHjk{$qlpCgv}\|$iPHrG";}elsif ($iPHrG ne "") {
$GuHjk{$qlpCgv} = $iPHrG;}}}sub PyjndTLnZ{local($eUBwUWO) = @_;
print "Content-Type: text/html\n\n";
print "<CENTER><H2>$eUBwUWO</H2></CENTER>\n";exit;}sub VyPBQ{{
print<<TWOZBso
<HTML>
<TITLE>E-mail Verifier</TITLE>
<BODY>
<CENTER>
<FONT FACE=Arial>
<H2>E-mail Verifier</H2>
Provided by <A HREF="http://www.cgiconnection.com">CGI Connection</A><BR><BR>

<TABLE BORDER=0 BGCOLOR=#CCCCCC>

<FORM METHOD=POST ACTION="$ENV{'SCRIPT_NAME'}">
<INPUT TYPE=hidden NAME=area VALUE="verify">
<TR><TD>Enter one e-mail address per line in the box below.<BR>
<TEXTAREA NAME=email COLS=50 ROWS=10></TEXTAREA>
<BR>
<INPUT TYPE=SUBMIT NAME=submit VALUE="Verify">
</TD></TR>
</FORM>
</TABLE>
</CENTER>
</FONT>
</BODY>
</HTML>
TWOZBso
}}sub UcTRusGRf { die "TIMEOUT\n" }; # replacement signal
sub YEQIpI{{
print<<TWOZBso
<HTML><TITLE>E-mail Verifier</TITLE><BODY><CENTER>
<FONT FACE="Arial"><H2>E-mail Verifier</H2>
Provided by <A HREF="http://www.cgiconnection.com">CGI Connection</A><BR><BR>
<FORM NAME="verify">
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=0 WIDTH=600 BGCOLOR="#CCCCCC">

TWOZBso
}for ($aRKWRNhD = 1; $aRKWRNhD < ($SJwAwytxf + 1); $aRKWRNhD++){
print "<TR><TD><INPUT NAME=loc$aRKWRNhD SIZE=2></TD> <TD><INPUT NAME=email$aRKWRNhD SIZE=50></TD> <TD><INPUT NAME=status$aRKWRNhD SIZE=15></TD></TR>\n";
}{
print<<TWOZBso
<TR><TD><B>Download:</B></TD> <TD>[ <A HREF="$ENV{'SCRIPT_NAME'}?area=download&filename=emails.txt&server_filename=$pdFdoqDv" target=_blank>E-mails</A> ] <B>Valid:</B> <INPUT NAME=valid SIZE=5 VALUE=\"0\"></TD></TR>
</TABLE></FORM><BR>
<A HREF="$ENV{'SCRIPT_NAME'}">Verify More</A></CENTER></FONT></BODY></HTML>
TWOZBso
}}sub pLBvHxWbJ{splice(@MOFtxRi, 0);
my $pIUimWyEb = $GuHjk{'server_filename'};my $SxStVK = $GuHjk{'filename'};
my $xSWdKavq = "$hSyBpc$pIUimWyEb";my @MOFtxRi = stat("$xSWdKavq");
my ($VNARiu,$VRAgUxbx,$CiOAxDqK,$JNdyjdf,$dCNaUpZSN,$mmLJl,$RvUHZ,$FvNyPJIR,$EkTjPnHwu,$iaeuWjsy,$iQQXHdI,$BivKqb,$XRxSpxWQr) = @MOFtxRi;
if ($SxStVK eq "" or $SxStVK eq "." or $SxStVK eq ".."){
print "Content-type: text/html\n\n";print "<HTML><BODY>\n";
print "You must specify a filename to download\n";         ##
          ###### π:-# Ç„# 0˚+ä###
   # SÄv1## ª·[[## Ï.]Ü# $sØå# õ## íe### ·ä#

print "</BODY></HTML>\n";exit;}print "Content-length: $FvNyPJIR\n";
print "Content-type: application/octect-stream\n";              ## # bü# ## …õ# ##### ö## 4# ˛ˆéL# s#
            #
       # ### ### õá####

print "Content-disposition: attachment;filename=$SxStVK\n\n";
my $ygRfCtHPL = 0, $eKLjAk = 0, $ZDnwYr = 4096;open (DL, "<$xSWdKavq");
until ($ygRfCtHPL == 1){$ruaUC = "";if ($eKLjAk >= $FvNyPJIR){
$ZDnwYr = $eKLjAk - $FvNyPJIR;$ygRfCtHPL = 1;            ## vs# |í# ∫Ÿ## ## @Ÿ9# :â# £#### ø÷h# !V# £5##
           # ˜##
               # /›# Gl## è≈T5## –+# ˆò#### eØ_°#####
                   # Ô# ∆úD# äZ^≥# O## ^# ™Ç=ø### 33# ì## Ô]#
 # Ë### ®¥5# ‡# =# Ç# é# v# #
      # z## K˚¬# ú.## # ˘# ## z“û# >e»# #
}sysread (DL, $ruaUC, $ZDnwYr);print "$ruaUC";        # ^## lW# “—ô##### ô# ©Êﬂ## •úãP# ##
$eKLjAk = $eKLjAk + $ZDnwYr;}close(DL);}sub VdtsSM{
my ($fJwIuTa, $AHJHXAgao) = @_;
print "<SCRIPT>document.verify.status$fJwIuTa.value = '$AHJHXAgao';</SCRIPT>\n";
}
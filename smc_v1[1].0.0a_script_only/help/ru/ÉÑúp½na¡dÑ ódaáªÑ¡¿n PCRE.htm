<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title> * Регулярные выражения (шаблоны) * </title>
</head>

<body>

<ul>
    <li><h2>* Регулярные выражения
        (шаблоны) * </h2>
    </li>
</ul>

<pre>В данной главе описывается синтаксис регулярных выражений. Чаще всего
в Пел они используюстя в операторах поиска и замены таких как s//
m/ операторах связки =~ или != и т.д.
Как правило все эти операторы имеют схожие опции такие как:

	i	- не различать строчные и заглавные буквы.
	m	- считать строку многострочной.
	s	- однострочная строка.
	x	- расширенный синтаксис ( использование пробелов и комментариев)

Обычно все эти опции обозначают как '/x'. Их можно использовать даже
внутри шаблонов использую новую конструкцию (?...)

Регулярные выражения или шаблоны (pattern) то же самое что и regexp
процедуры в Юниксе. Выражения и синтаксис заимствован из свободно
распространяемых процедур V8 Генри Спенсера (Henry Spencer) там же
они подробно и описаны.

В шаблонах используются следующие метасимволы (символы обозначающие
группы других символов) часто называемых egrep - стандартом:

	\	- считать следующий метасимвол как обычный символ.
	^	- начало строки
	.	- один произвольный символ. Кроме '\n' - конец строки.
	$	- конец строки
	|	- альтернатива (или)
	()	- группировка
	[]	- класс символов

Метасимволы имеют модификаторы (пишутся после метасимвола):

	*	- повторяется 0 или большее число раз
	+	- -//- 1 или большее число раз
	?	- 1 или 0 раз
	{n}	- точно n раз
	{n,}	- по меньшей мере раз
	{n,m}	- не менше n, но и не больше m

Во все других случаях фигурные скобки считаются обычными (регулярными)
символами. Таким образом '*' эквивалентна {0,} , '+' - {1,}
и '?' - {0,1}. n и m не могут быть больше 65536.

По умолчанию действие метасимволов &quot;жадно&quot; (greedy). Совпадение
распространяется столько раз сколько возможно не учитывая результат
действия следуюющих метасимволов. Если вы хотите &quot;уменьшить их аппетит&quot;
то используйте символ '?'. Это не изменяет значение метасимволов
просто уменьшает распространение. Таким образом:

	*?	- станет 0 и более
	+?	- 1 и более
	??	- 0 или 1 раз
	{n}?	- точно n раз
	{n,}?	- не меньше n раз
	{n,m}?	- больше или равно n и меньше m раз

Шаблоны работают так же как и двойные кавычки поэтому в них можно
использовать `\` - символы (бакслэш-символы):

	\t	- символ табуляции
	\n	- новая строка
	\r	- перевод каретки
	\а	- перевол формата
	\v	- вертикальная табуляция
	\a	- звонок
	\e	- escape
	\033	- восьмеричная запись символа
	\x1A	- шестнадцатеричная
	\c[	- control символ
	\l	- нижний регистр следующего символа
	\u	- верхний регистр -//-
	\L	- все символы в нижнем регистре до \E
	\U	- в верхнем -//-
	\E	- ограничитель смены регистра
	\Q	- отмена действия как метасимвола

Дополнительно в Пел добавлены следующие метасимволы:

	\w	- алфавитно-цифровой или '_' символ
	\W	- не -//-
	\s	- один пробел
	\S	- один не пробел
	\d	- одна цифра
	\D	- одна не цифра

Обратите внимание что все это &quot;один&quot; символ. Для обозначения последовательности
применяйте модификаторы. Так:

	\w+	- слово
	\d+	- целое число
	[+-]?\d+	- целое со знаком
	[+-]?\d+\.?\d*	- число с точкой

Кроме того существуют мнимые метасимволы. Обозначающие не существующие
символы в месте смены значения. Такие как:

	\b	- граница слова
	\B	- не граница слова
	\A	- начало строки
	\Z	- конец строки
	\G	- конец действия m//g

Граница слова (\b) - это мнимая точка между символами \w и \W.
Внутри класса символов '\b' обозначает символ backspace (стирания).
Метасимволы \A и \Z - аналогичны '^' и '$' но если началостроки '^'
и конец строки '$' действуют для каждой строки в многосторочной строке
то \A и \Z обозначают начало и конец всей многосторчной строки.

Если внутри шаблона применяется группировка (круглые скобки)
то номер подстроки группы обозначается как '\цифра'.
Заметьте что за шаблоном в пределах выражения или блока эти группы обозначаются
как '$цифра'. Кроме этого существуют дополнительные переменные:

	$+	- обозначает последнее совпадение
	$&amp;	- все совпадение
	$`	- все до совпадения
	$'	- все после совпадения

Пример:

$s = &quot;Один 1 два 2 и три 3&quot;;
if ($s =~ /(\d+)\D+(\d+)/)
    {
        print &quot;$1\n&quot;;	# Результат '1'
        print &quot;$2\n&quot;;	# '2'
        print &quot;$+\n&quot;;	# '2'
        print &quot;$&amp;\n&quot;;	# '1 два 2'
        print &quot;$`\n&quot;;	# 'Один '
        print &quot;$'\n&quot;;	# ' и три 3'
   }


</pre>

<ul>
    <li><h2>Пел версии 5 содержит
        дополнительные конструкции
        шаблонов:</h2>
    </li>
</ul>

<pre>(?#комментарий)	- комментарий в теле шаблона.

	(?:шаблон)	- группировка как и '( )' но без обратной ссылки

	(?=шаблон)	- &quot;заглядывание&quot; вперед. Например /\w+(?=\t)/
			соответствует слову за котоым идет табуляция
но символ '\t' не включается в результат.

Пример:
$s = &quot;1+2-3*4&quot;;
if ($s =~ /(\d)(?=-)/)  # Наити цифру за которой стоит '-'
    {
        print &quot;$1\n&quot;;   # Результат '2'
   }
else { print &quot;ошибка поиска\n&quot;;}


	(?!шаблон)	- &quot;заглядывание&quot; вперед по отрицанию.

Пример:
$s = &quot;1+2-3*4&quot;;
if ($s =~ /(\d)(?!\+)/) # Наити цифру за которой не стоит '+'
    {
        print &quot;$1\n&quot;;   # Результат '2'
   }
else { print &quot;ошибка поиска\n&quot;;}


	(?ismx)	- &quot;внутренние&quot; модификаторы. Удобно применять в шаблонах
	где например нужно внутри шаблона указать модификатор.


</pre>

<ul>
    <li><h2>Правила регулярного
        выражения. (regex)</h2>
    </li>
</ul>

<pre>1. Любой символ обозначает себя самого если это не метасимвол.
	Если вам нужно отменить действие метасимвола то поставьте
	перед ним '\'.
	2. Строка символов обозначает строку этих символов.

	3. Множество возможных символов (класс) заключается в квадратные
	скобки '[]' это значит что в данном месте может стоять один
	из указанных в скобках символ. Если первый символ в скобках
	это '^' - значит не один из указанных символов не может
	стоять в данном месте выражения. Внутри класса можно употреблять
	символ '-' обозначающий диаппазон символов. Например a-z
	один из малых букв латинского алфавита, 0-9 - цифра и т.д.

	4. Все символы, включая специальные можно обозначать с
	помощью '\' как в языке С.

	5. Альтернативные последовательности разделяются символом '|'
	Заметьте что внутри квадратных скобок это обычный символ.

	6. Внутри регулярного выражения можно указыват &quot;подшаблоны&quot;
	заключая их в крунлые скобки и ссылаться на них как '\номер'
	Первая скобка обозначается как '\1'.
</pre>
</body>
</html>
